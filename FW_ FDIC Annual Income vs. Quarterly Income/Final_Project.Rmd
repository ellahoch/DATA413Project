---
title: "Final_Project_Christoff"
author: "Lucy Christoff"
date: "2024-04-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Preparing Annual Income Data
data <- read.csv("Annual_Income.csv")  
# Preparing Quarterly Income Data
data <- read.csv("Quarterly_Income.csv")  
```

```{r}
# Reviewing my data for Annual_Income
data <- read.csv("Annual_Income.csv")
head(data)
str(data)
View(data)
```

```{r}
# Reviewing my data for Quarterly_Income
data <- read.csv("Quarterly_Income.csv")
head(data)
str(data)
View(data)
```

```{r}
# Installing Shiny
if (!require("shiny")) install.packages("shiny")
if (!require("ggplot2")) install.packages("ggplot2")
if (!require("dplyr")) install.packages("dplyr")

library(shiny)
library(ggplot2)
library(dplyr)
```


```{r}
# Creating Histograms, Boxplots, and a Correlation Plot
# UI for the Shiny App
ui <- fluidPage(
    titlePanel("Preliminary Data Analysis App"),
    sidebarLayout(
        sidebarPanel(
            
            selectInput("varSelect", "Select Variable for Histogram:", 
                        choices = NULL), 
            selectInput("boxSelect", "Select Variable for Boxplot:", 
                        choices = NULL), 
            selectInput("corrSelect1", "Select X Variable for Correlation:",                                      choices = NULL),
            selectInput("corrSelect2", "Select Y Variable for Correlation:", 
                        choices = NULL),
            selectInput("regressionSelect1", "Select X Variable for Regression:", 
                        choices = NULL),
            selectInput("regressionSelect2", "Select Y Variable for Regression:", 
                        choices = NULL)
        ),
        mainPanel(
            plotOutput("histPlot"),
            plotOutput("boxPlot"),
            plotOutput("corrPlot"),
            verbatimTextOutput("regressionSummary")
        )
    )
)
```

```{r}
# Defining the server
server <- function(input, output, session) {
  
   
    dataset <- reactive({
        readr::read_csv("annual-income_update.csv")
    })
    
    
    observe({
        df <- dataset()
        updateSelectInput(session, "varSelect", choices = names(df))
        updateSelectInput(session, "boxSelect", choices = names(df))
        updateSelectInput(session, "corrSelect1", choices = names(df))
        updateSelectInput(session, "corrSelect2", choices = names(df))
        updateSelectInput(session, "regressionSelect1", choices = names(df))
        updateSelectInput(session, "regressionSelect2", choices = names(df))
    })
    
    
    output$histPlot <- renderPlot({
        req(input$varSelect)
        df <- dataset()
        ggplot(df, aes_string(x = (input$varSelect))) + 
            geom_histogram(bins = 30, fill = "blue", color = "green") +
            labs(title = paste("Histogram of", input$varSelect))
    })
    
    
    output$boxPlot <- renderPlot({
        req(input$boxSelect)
        df <- dataset()
        ggplot(df, aes_string(y = input$boxSelect)) + 
            geom_boxplot(fill = "yellow", color = "pink") +
            labs(title = paste("Boxplot of", input$boxSelect))
    })
    
    
    output$corrPlot <- renderPlot({
        req(input$corrSelect1, input$corrSelect2)
        df <- dataset()
        ggplot(df, aes_string(x = input$corrSelect1, y = input$corrSelect2)) +
            geom_point(alpha = 0.6) +
            geom_smooth(method = "lm", color = "red", se = FALSE) +
            labs(title = paste("Scatter Plot of", input$corrSelect1, "vs", input$corrSelect2))
    })
    
    
    output$regressionSummary <- renderPrint({
        req(input$regressionSelect1, input$regressionSelect2)
        df <- dataset()
        lm_model <- lm(df[[input$regressionSelect2]] ~ df[[input$regressionSelect1]], data = df)
        summary(lm_model)
    })
}
```

```{r}
# Running my Shiny App
shinyApp(ui = ui, server = server)
```

```{r}

```

